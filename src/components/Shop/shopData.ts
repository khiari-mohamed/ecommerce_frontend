// src/components/Shop/shopData.ts
import { Product } from "@/types/product";

// Static data - remains exactly the same as your current file
const staticShopData: Product[] = [
  {
    title: "MASS GAINER 7KG - WARRIORS",
    reviews: [],
    price: 260.0,
    discountedPrice: 239.0,
    currency: "DT",
    id: 1,
    imgs: {
      thumbnails: [
        "/images/products/1.webp",
        "/images/products/1.webp",
      ],
      previews: [
        "/images/products/1.webp",
        "/images/products/1.webp",
      ],
    },
    _id: "1",
    designation: "MASS GAINER 7KG - WARRIORS",
    slug: "mass-gainer-7kg-warriors",
    mainImage: { url: "/images/products/1.webp" },
    images: [
      { url: "/images/products/1.webp" },
      { url: "/images/products/1.webp" }
    ],
    zone1: 0,
    zone2: 0,
    zone3: 0,
    zone4: 0,
    // Add the required fields with default/empty values:
    content_seo: "",
    meta: "", // <-- fix here
    aroma_ids: [],
    type: "",
  },
  {
    title: "NITRO TECH RIPPED – 1.8 KG MUSCLETECH",
    reviews: [],
    price: 280.0,
    discountedPrice: 239.0,
    currency: "DT",
    id: 2,
    imgs: {
      thumbnails: [
        "/images/products/p2.webp",
        "/images/products/p2.webp",
      ],
      previews: [
        "/images/products/p2.webp",
        "/images/products/p2.webp",
      ],
    },
    _id: "2",
    designation: "NITRO TECH RIPPED – 1.8 KG MUSCLETECH",
    slug: "nitro-tech-ripped-1-8kg-muscletech",
    mainImage: { url: "/images/products/p2.webp" },
    images: [
      { url: "/images/products/p2.webp" },
      { url: "/images/products/p2.webp" }
    ],
    zone1: 0,
    zone2: 0,
    zone3: 0,
    zone4: 0,
    content_seo: "",
    meta: "",
    aroma_ids: [],
    type: "",
  },
  {
    title: "SERIOUS MASS – 5,45 KG",
    reviews: [],
    price: 400.0,
    discountedPrice: 349.0,
    currency: "DT",
    id: 3,
    imgs: {
      thumbnails: [
        "/images/products/p3.webp",
        "/images/products/p3.webp",
      ],
      previews: [
        "/images/products/p3.webp",
        "/images/products/p3.webp",
      ],
    },
    _id: "3",
    designation: "SERIOUS MASS – 5,45 KG",
    slug: "serious-mass-5-45-kg",
    mainImage: { url: "/images/products/p3.webp" },
    images: [
      { url: "/images/products/p3.webp" },
      { url: "/images/products/p3.webp" }
    ],
    zone1: 0,
    zone2: 0,
    zone3: 0,
    zone4: 0,
    content_seo: "",
     meta: "",
    aroma_ids: [],
    type: "",
  },
  {
    title: "100% WHEY GOLD STANDARD – 2.27KG",
    reviews: [],
    price: 350.0,
    discountedPrice: 329.0,
    currency: "DT",
    id: 4,
    imgs: {
      thumbnails: [
        "/images/products/p4.webp",
        "/images/products/p4.webp",
      ],
      previews: [
        "/images/products/p4.webp",
        "/images/products/p4.webp",
      ],
    },
    _id: "4",
    designation: "100% WHEY GOLD STANDARD – 2.27KG",
    slug: "100-whey-gold-standard-2-27kg",
    mainImage: { url: "/images/products/p4.webp" },
    images: [
      { url: "/images/products/p4.webp" },
      { url: "/images/products/p4.webp" }
    ],
    zone1: 0,
    zone2: 0,
    zone3: 0,
    zone4: 0,
    content_seo: "",
     meta: "",
    aroma_ids: [],
    type: "",
  },
  {
    title: "REAL ISOLATE – 1,8 KG",
    reviews: [],
    price: 320.0,
    discountedPrice: 289.0,
    currency: "DT",
    id: 5,
    imgs: {
      thumbnails: [
        "/images/products/p5.webp",
        "/images/products/p5.webp",
      ],
      previews: [
        "/images/products/p5.webp",
        "/images/products/p5.webp",
      ],
    },
    _id: "5",
    designation: "REAL ISOLATE – 1,8 KG",
    slug: "real-isolate-1-8-kg",
    mainImage: { url: "/images/products/p5.webp" },
    images: [
      { url: "/images/products/p5.webp" },
      { url: "/images/products/p5.webp" }
    ],
    zone1: 0,
    zone2: 0,
    zone3: 0,
    zone4: 0,
    content_seo: "",
     meta: "",
    aroma_ids: [],
    type: "",
  },
  {
    title: "REAL MASS – 6.8 KG",
    reviews: [],
    price: 260.0,
    discountedPrice: 239.0,
    currency: "DT",
    id: 6,
    imgs: {
      thumbnails: [
        "/images/products/p6.webp",
        "/images/products/p6.webp",
      ],
      previews: [
        "/images/products/p6.webp",
        "/images/products/p6.webp",
      ],
    },
    _id: "6",
    designation: "REAL MASS – 6.8 KG",
    slug: "real-mass-6-8-kg",
    mainImage: { url: "/images/products/p6.webp" },
    images: [
      { url: "/images/products/p6.webp" },
      { url: "/images/products/p6.webp" }
    ],
    zone1: 0,
    zone2: 0,
    zone3: 0,
    zone4: 0,
    content_seo: "",
     meta: "",
    aroma_ids: [],
    type: "",
  },
  {
    title: "WHEY 80 – 2,25 KG",
    reviews: [],
    price: 260.0,
    discountedPrice: 239.0,
    currency: "DT",
    id: 7,
    imgs: {
      thumbnails: [
        "/images/products/p7.webp",
        "/images/products/p7.webp",
      ],
      previews: [
        "/images/products/p7.webp",
        "/images/products/p7.webp",
      ],
    },
    _id: "7",
    designation: "WHEY 80 – 2,25 KG",
    slug: "whey-80-2-25-kg",
    mainImage: { url: "/images/products/p7.webp" },
    images: [
      { url: "/images/products/p7.webp" },
      { url: "/images/products/p7.webp" }
    ],
    zone1: 0,
    zone2: 0,
    zone3: 0,
    zone4: 0,
    content_seo: "",
     meta: "",
    aroma_ids: [],
    type: "",
  },
  {
    title: "OPTI-MEN - 90TABS",
    reviews: [],
    price: 150.0,
    discountedPrice: 119.0,
    currency: "DT",
    id: 8,
    imgs: {
      thumbnails: [
        "/images/products/p8.png",
        "/images/products/p8.png",
      ],
      previews: [
        "/images/products/p8.png",
        "/images/products/p8.png",
      ],
    },
    _id: "8",
    designation: "OPTI-MEN - 90TABS",
    slug: "opti-men-90tabs",
    mainImage: { url: "/images/products/p8.png" },
    images: [
      { url: "/images/products/p8.png" },
      { url: "/images/products/p8.png" }
    ],
    zone1: 0,
    zone2: 0,
    zone3: 0,
    zone4: 0,
    content_seo: "",
     meta: "",
    aroma_ids: [],
    type: "",
  },
];

// Dynamic data storage
let dynamicShopData: Product[] = [];

/**
 * Updates the shop data with products from API
 * @param products Array of Product objects from API
 */
export const setShopData = (products: Product[]) => {
  dynamicShopData = products.map(product => ({
    ...product,
    title: product.designation || product.title,
    discountedPrice: product.price,
    price: product.oldPrice || product.price,
    reviews: product.reviews?.map(review => ({
      _id: review._id || "",
      id: review.id || "",
      user_id: review.user_id || "",
      product_id: review.product_id || product._id || "",
      stars: typeof review.stars === "number"
        ? review.stars
        : typeof review.stars === "string"
          ? Number(review.stars)
          : typeof review.rating === "number"
            ? review.rating
            : 0,
      comment: review.comment || "",
      rating: review.rating ?? (typeof review.stars === "number" ? review.stars : Number(review.stars)) ?? 0,
      publier: typeof review.publier === "boolean"
        ? String(review.publier)
        : typeof review.publier === "string"
          ? review.publier
          : "true",
      created_at: review.created_at ?? "",
      updated_at: review.updated_at ?? "",
    })) || [],
    id: parseInt(product._id) || 0,
    currency: "DT",
    imgs: {
      thumbnails: [product.mainImage.url, ...(product.images?.map(img => img.url) || [])],
      previews: [product.mainImage.url, ...(product.images?.map(img => img.url) || [])]
    },
    // Ensure all required fields are present
    _id: product._id,
    designation: product.designation,
    slug: product.slug,
    mainImage: product.mainImage,
    images: product.images || [],
    zone1: product.zone1 ?? 0,
    zone2: product.zone2 ?? 0,
    zone3: product.zone3 ?? 0,
    zone4: product.zone4 ?? 0,
    content_seo: product.content_seo ?? "",
    meta: product.meta ?? "",
    aroma_ids: product.aroma_ids ?? [],
    type: product.type ?? "",
  }));
};
/**
 * Gets the current shop data (dynamic if available, static as fallback)
 */
export const getShopData = () => {
  return dynamicShopData.length > 0 ? dynamicShopData : staticShopData;
};

// Default export maintains backward compatibility
const shopData = getShopData();
export default shopData;