// src/components/Shop/shopData.ts
import { Product } from "@/types/product";

// Static data - remains exactly the same as your current file
const staticShopData: Product[] = [
  {
    title: "MASS GAINER 7KG - WARRIORS",
    reviews: 15,
    price: 260.0,
    discountedPrice: 239.0,
    currency: "DT",
    id: 1,
    imgs: {
      thumbnails: [
        "/images/products/1.webp",
        "/images/products/1.webp",
      ],
      previews: [
        "/images/products/1.webp",
        "/images/products/1.webp",
      ],
    },
    _id: "1",
    designation: "MASS GAINER 7KG - WARRIORS",
    slug: "mass-gainer-7kg-warriors",
    mainImage: { url: "/images/products/1.webp" },
    images: [
      { url: "/images/products/1.webp" },
      { url: "/images/products/1.webp" }
    ]
  },
  {
    title: "NITRO TECH RIPPED – 1.8 KG MUSCLETECH",
    reviews: 5,
    price: 280.0,
    discountedPrice: 239.0,
    currency: "DT",
    id: 2,
    imgs: {
      thumbnails: [
        "/images/products/p2.webp",
        "/images/products/p2.webp",
      ],
      previews: [
        "/images/products/p2.webp",
        "/images/products/p2.webp",
      ],
    },
    _id: "2",
    designation: "NITRO TECH RIPPED – 1.8 KG MUSCLETECH",
    slug: "nitro-tech-ripped-1-8kg-muscletech",
    mainImage: { url: "/images/products/p2.webp" },
    images: [
      { url: "/images/products/p2.webp" },
      { url: "/images/products/p2.webp" }
    ]
  },
  {
    title: "SERIOUS MASS – 5,45 KG",
    reviews: 5,
    price: 400.0,
    discountedPrice: 349.0,
    currency: "DT",
    id: 3,
    imgs: {
      thumbnails: [
        "/images/products/p3.webp",
        "/images/products/p3.webp",
      ],
      previews: [
        "/images/products/p3.webp",
        "/images/products/p3.webp",
      ],
    },
    _id: "3",
    designation: "SERIOUS MASS – 5,45 KG",
    slug: "serious-mass-5-45-kg",
    mainImage: { url: "/images/products/p3.webp" },
    images: [
      { url: "/images/products/p3.webp" },
      { url: "/images/products/p3.webp" }
    ]
  },
  {
    title: "100% WHEY GOLD STANDARD – 2.27KG",
    reviews: 6,
    price: 350.0,
    discountedPrice: 329.0,
    currency: "DT",
    id: 4,
    imgs: {
      thumbnails: [
        "/images/products/p4.webp",
        "/images/products/p4.webp",
      ],
      previews: [
        "/images/products/p4.webp",
        "/images/products/p4.webp",
      ],
    },
    _id: "4",
    designation: "100% WHEY GOLD STANDARD – 2.27KG",
    slug: "100-whey-gold-standard-2-27kg",
    mainImage: { url: "/images/products/p4.webp" },
    images: [
      { url: "/images/products/p4.webp" },
      { url: "/images/products/p4.webp" }
    ]
  },
  {
    title: "REAL ISOLATE – 1,8 KG",
    reviews: 3,
    price: 320.0,
    discountedPrice: 289.0,
    currency: "DT",
    id: 5,
    imgs: {
      thumbnails: [
        "/images/products/p5.webp",
        "/images/products/p5.webp",
      ],
      previews: [
        "/images/products/p5.webp",
        "/images/products/p5.webp",
      ],
    },
    _id: "5",
    designation: "REAL ISOLATE – 1,8 KG",
    slug: "real-isolate-1-8-kg",
    mainImage: { url: "/images/products/p5.webp" },
    images: [
      { url: "/images/products/p5.webp" },
      { url: "/images/products/p5.webp" }
    ]
  },
  {
    title: "REAL MASS – 6.8 KG",
    reviews: 15,
    price: 260.0,
    discountedPrice: 239.0,
    currency: "DT",
    id: 6,
    imgs: {
      thumbnails: [
        "/images/products/p6.webp",
        "/images/products/p6.webp",
      ],
      previews: [
        "/images/products/p6.webp",
        "/images/products/p6.webp",
      ],
    },
    _id: "6",
    designation: "REAL MASS – 6.8 KG",
    slug: "real-mass-6-8-kg",
    mainImage: { url: "/images/products/p6.webp" },
    images: [
      { url: "/images/products/p6.webp" },
      { url: "/images/products/p6.webp" }
    ]
  },
  {
    title: "WHEY 80 – 2,25 KG",
    reviews: 15,
    price: 260.0,
    discountedPrice: 239.0,
    currency: "DT",
    id: 7,
    imgs: {
      thumbnails: [
        "/images/products/p7.webp",
        "/images/products/p7.webp",
      ],
      previews: [
        "/images/products/p7.webp",
        "/images/products/p7.webp",
      ],
    },
    _id: "7",
    designation: "WHEY 80 – 2,25 KG",
    slug: "whey-80-2-25-kg",
    mainImage: { url: "/images/products/p7.webp" },
    images: [
      { url: "/images/products/p7.webp" },
      { url: "/images/products/p7.webp" }
    ]
  },
  {
    title: "OPTI-MEN - 90TABS",
    reviews: 15,
    price: 150.0,
    discountedPrice: 119.0,
    currency: "DT",
    id: 8,
    imgs: {
      thumbnails: [
        "/images/products/p8.png",
        "/images/products/p8.png",
      ],
      previews: [
        "/images/products/p8.png",
        "/images/products/p8.png",
      ],
    },
    _id: "8",
    designation: "OPTI-MEN - 90TABS",
    slug: "opti-men-90tabs",
    mainImage: { url: "/images/products/p8.png" },
    images: [
      { url: "/images/products/p8.png" },
      { url: "/images/products/p8.png" }
    ]
  },
];

// Dynamic data storage
let dynamicShopData: Product[] = [];

/**
 * Updates the shop data with products from API
 * @param products Array of Product objects from API
 */
export const setShopData = (products: Product[]) => {
  dynamicShopData = products.map(product => ({
    ...product,
    // Map API product structure to our expected structure
    title: product.designation || product.title,
    discountedPrice: product.price,
    price: product.oldPrice || product.price,
    reviews: product.reviews?.map(review => ({
      userId: review.userId,
      userName: review.userName,
      rating: review.rating,
      comment: review.comment,
      createdAt: review.createdAt,
    })) || [],
    id: parseInt(product._id) || 0,
    currency: "DT",
    // Ensure images structure matches our static data
    imgs: {
      thumbnails: [product.mainImage.url, ...(product.images?.map(img => img.url) || [])],
      previews: [product.mainImage.url, ...(product.images?.map(img => img.url) || [])]
    },
    // Ensure all required fields are present
    _id: product._id,
    designation: product.designation,
    slug: product.slug,
    mainImage: product.mainImage,
    images: product.images || []
  }));
};
/**
 * Gets the current shop data (dynamic if available, static as fallback)
 */
export const getShopData = () => {
  return dynamicShopData.length > 0 ? dynamicShopData : staticShopData;
};

// Default export maintains backward compatibility
const shopData = getShopData();
export default shopData;